{"ast":null,"code":"import React,{useState,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Diagnose(){const[selectedFile,setSelectedFile]=useState(null);const[fileName,setFileName]=useState(\"Upload a clear photo...\");const[diagnosisResult,setDiagnosisResult]=useState(null);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[imagePreviewUrl,setImagePreviewUrl]=useState(null);// State for image preview\nconst fileInputRef=useRef(null);// Handles file selection, sets file name, creates image preview, and performs basic validation.\nconst handleFileChange=event=>{const file=event.target.files[0];if(file){// Basic file size validation (max 5MB)\nif(file.size>5*1024*1024){setError(\"File size exceeds 5MB limit.\");setSelectedFile(null);setFileName(\"Upload a clear photo...\");setImagePreviewUrl(null);return;}setSelectedFile(file);setFileName(file.name);setDiagnosisResult(null);// Clear previous results\nsetError(null);// Clear previous errors\n// Create a preview URL for the image to display to the user\nconst reader=new FileReader();reader.onloadend=()=>{setImagePreviewUrl(reader.result);};reader.readAsDataURL(file);}else{// Reset all states if no file is selected\nsetSelectedFile(null);setFileName(\"Upload a clear photo...\");setDiagnosisResult(null);setError(null);setImagePreviewUrl(null);}};// Handles the \"Upload and Check Availability\" button click, sending the image to the backend.\nconst handleDiagnosisClick=async()=>{if(!selectedFile){setError(\"Please select a photo to upload.\");return;}// Clear previous errors and results when starting a new diagnosis\nsetError(null);setDiagnosisResult(null);setIsLoading(true);// Indicate loading state\nconst formData=new FormData();formData.append('img',selectedFile);try{// Send the image to your Flask backend's upload endpoint\nconst response=await fetch('http://127.0.0.1:5000/upload/',{method:'POST',body:formData});if(!response.ok){let errorData={error:`HTTP error! status: ${response.status}`};try{const responseText=await response.text();errorData=JSON.parse(responseText);}catch(e){console.error(\"Error parsing server response as JSON:\",e);}throw new Error(errorData.error||`HTTP error! status: ${response.status}`);}const data=await response.json();setDiagnosisResult(data.prediction);}catch(error){console.error(\"Error during diagnosis:\",error);setError(`Failed to get diagnosis: ${error.message}. Please try again.`);}finally{setIsLoading(false);// End loading state\n}};// Triggers the hidden file input when the visible input group is clicked.\nconst triggerFileInput=()=>{fileInputRef.current.click();};return/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'calc(100vh - 90px)',paddingTop:'90px',paddingBottom:'2rem',fontFamily:'var(--font-inter)'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"container d-flex flex-column align-items-center justify-content-center text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",style:{marginTop:'2rem'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera-retro fa-3x text-success mb-2\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"display-6 fw-bold mb-3\",children:\"Worried About Your Plant? Let AI Help!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"lead text-muted px-md-5\",children:\"Upload a clear photo of your plant. Our AI will analyze it and provide potential diagnoses and care tips.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card shadow-sm p-4 mb-5\",style:{maxWidth:'700px',width:'100%',borderRadius:'0.75rem',backgroundColor:'#fff5f5'// Light red background\n},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-start\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title mb-3 fw-bold text-danger\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle me-2\"}),\" How It Works\"]}),/*#__PURE__*/_jsxs(\"ol\",{className:\"list-group list-group-flush\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"list-group-item border-0 ps-0 py-1\",style:{backgroundColor:'transparent'},children:\"\\uD83D\\uDCF7 1. Take a clear, well-lit photo of the affected plant part or the whole plant.\"}),/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item border-0 ps-0 py-1\",style:{backgroundColor:'transparent'},children:[\"\\uD83E\\uDD16 2. Click \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\\"Diagnose Now\\\"\"}),\" and our AI will analyze the photo.\"]}),/*#__PURE__*/_jsx(\"li\",{className:\"list-group-item border-0 ps-0 py-1\",style:{backgroundColor:'transparent'},children:\"\\uD83C\\uDF31 3. Receive a diagnosis and care tips instantly!\"})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n                @keyframes fadeInNote {\n                  0% {\n                    opacity: 0;\n                    transform: translateY(10px);\n                  }\n                  100% {\n                    opacity: 1;\n                    transform: translateY(0);\n                  }\n                }\n              `}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded shadow-sm\",style:{backgroundColor:'#ffe6e6',// soft cherry red background\nborderLeft:'5px solid #e60026',// cherry red border\ncolor:'#cc0000',// cherry red text\nfontWeight:600,fontSize:'1rem',animation:'fadeInNote 1.2s ease-out',transition:'all 0.5s ease-in-out'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle me-2\",style:{color:'#cc0000'}}),/*#__PURE__*/_jsx(\"strong\",{children:\"NOTE:\"}),\" For best results, pick a single leaf, keep it in an empty background, then upload and diagnose.\"]})]})}),/*#__PURE__*/_jsx(\"style\",{children:`\n            @keyframes diagnoseFadeUp {\n              0% {\n                opacity: 0;\n                transform: translateY(20px);\n              }\n              100% {\n                opacity: 1;\n                transform: translateY(0);\n              }\n            }\n          `}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 shadow\",style:{maxWidth:'720px',width:'100%',background:'#f0fff4',// soft mint green\nborderRadius:'1rem',boxShadow:'0 10px 25px rgba(0, 0, 0, 0.05)',transition:'transform 0.3s ease, box-shadow 0.3s ease'},onMouseEnter:e=>{e.currentTarget.style.transform='translateY(-4px)';e.currentTarget.style.boxShadow='0 12px 30px rgba(0, 0, 0, 0.08)';},onMouseLeave:e=>{e.currentTarget.style.transform='translateY(0)';e.currentTarget.style.boxShadow='0 10px 25px rgba(0, 0, 0, 0.05)';},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-start\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title mb-4 fw-bold text-success\",children:\"\\uD83E\\uDEB4 Diagnose Your Plant \\uD83C\\uDF3F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"plantPhotoInput\",className:\"form-label fw-bold\",children:\"Plant Photo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"plantPhotoInput\",ref:fileInputRef,onChange:handleFileChange,style:{display:'none'},accept:\".jpg, .jpeg, .png, .webp\"// Allowed file types\n}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",onClick:triggerFileInput,style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-white border-end-0\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera text-muted\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"displayPlantPhoto\",placeholder:\"Upload a clear photo...\",\"aria-label\":\"Upload a clear photo\",readOnly:true,value:fileName})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-text text-muted mt-2\",children:\"Max 5MB. JPG, PNG, WEBP formats accepted.\"}),imagePreviewUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-center\",children:/*#__PURE__*/_jsx(\"img\",{src:imagePreviewUrl,alt:\"Plant Preview\",style:{maxWidth:'100%',height:'auto',borderRadius:'0.5rem',border:'1px solid #ddd',boxShadow:'0 4px 8px rgba(0,0,0,0.1)'}})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-success btn-lg rounded-pill\",style:{fontSize:'1.2rem',padding:'0.75rem 1.5rem',fontWeight:'bold',backgroundColor:'#28a745',borderColor:'#28a745',color:'white',transition:'background-color 0.3s ease, transform 0.2s ease'},onMouseEnter:e=>e.currentTarget.style.backgroundColor='#218838',onMouseLeave:e=>e.currentTarget.style.backgroundColor='#28a745',onClick:handleDiagnosisClick,disabled:isLoading,children:isLoading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\",\"aria-hidden\":\"true\"}),\"Analyzing...\"]}):'Diagnose Now'})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-3\",role:\"alert\",children:error}),diagnosisResult&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-5 pt-3 border-top border-2\",children:[\" \",/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4 fw-bolder text-success\",children:\"\\uD83D\\uDD0D Diagnosis Result:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card shadow-lg\",style:{borderRadius:'1rem',backgroundColor:'#e9ecef'},children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-start p-4\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"card-subtitle text-muted mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-primary fs-6\",children:\"Disease Name:\"}),\" \"]}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text fw-bold text-dark\",style:{fontSize:'1.3rem',letterSpacing:'0.5px'},children:diagnosisResult.name.replace(/\\//g,' - ').replace(/\\\\/g,' ')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"card-subtitle text-muted mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-warning fs-6\",children:\"Cause:\"}),\" \"]}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text text-secondary\",style:{fontSize:'1.1rem',lineHeight:'1.7'},children:diagnosisResult.cause})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"card-subtitle text-muted mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-danger fs-6\",children:\"Cure/Care Tips:\"}),\" \"]}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text text-secondary\",style:{fontSize:'1.1rem',lineHeight:'1.7'},children:diagnosisResult.cure})]})]})]})]})]})})]})});}export default Diagnose;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}